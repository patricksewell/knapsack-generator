<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knapsack Problem Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Knapsack Problem Generator</h1>

        <div class="description-toggle">
            <button class="desc-btn" id="desc_toggle" onclick="this.parentElement.classList.toggle('open')">
                <span class="desc-arrow">▶</span> What is this?
            </button>
            <div class="desc-content">
                <p>The <strong>0/1 knapsack problem</strong> models a simple but powerful choice environment: a decision-maker must pick a subset of items, each with a price and a value, to maximize total value without exceeding a fixed budget.</p>
                <p>For behavioral economists, this structure is especially useful because it controls for preferences and provides a distance to an optimal solution. It can be used to study, for example, how people allocate scarce resources across competing options; whether they rely on heuristics rather than optimization; how limited attention or choice overload change decision quality; and how decisions respond to framing, time pressure, incentives, or complexity.</p>
                <p>Feel free to generate your own knapsack instances below, have fun! You can also set a seed for full reproducibility.</p>
                <div class="desc-figure">
                    <div class="desc-figure-caption">Illustrative Example</div>
                    <img src="example.png" alt="Illustrative example of a knapsack problem">
                </div>
            </div>
        </div>

        <div class="form-section">
            <div class="form-row">
                <div class="form-group">
                    <label for="n_items">Number of Items</label>
                    <input type="number" id="n_items" value="12" min="1">
                </div>
                <div class="form-group">
                    <label for="budget_min">Min Budget</label>
                    <input type="number" id="budget_min" value="50" min="1">
                </div>
                <div class="form-group">
                    <label for="budget_max">Max Budget</label>
                    <input type="number" id="budget_max" value="150" min="1">
                </div>
            </div>

            <div class="form-row dist-row">
                <div class="form-group">
                    <label for="weight_dist">Price Distribution</label>
                    <select id="weight_dist">
                        <option value="uniform">Uniform</option>
                        <option value="normal">Normal</option>
                        <option value="lognormal">Lognormal</option>
                    </select>
                    <label class="int-checkbox"><input type="checkbox" id="weight_int" checked> integer</label>
                </div>
                <div class="form-group params" id="weight_params">
                    <div class="param-group uniform-params">
                        <label>Min <input type="number" id="weight_min" value="1" min="1"></label>
                        <label>Max <input type="number" id="weight_max" value="20" min="1"></label>
                    </div>
                    <div class="param-group normal-params hidden">
                        <label>Mean <input type="number" id="weight_mean" value="10" step="0.1"></label>
                        <label>SD <input type="number" id="weight_sd" value="3" step="0.1" min="0.1"></label>
                    </div>
                    <div class="param-group lognormal-params hidden">
                        <label>μ <input type="number" id="weight_mu" value="2" step="0.1"></label>
                        <label>σ <input type="number" id="weight_sigma" value="0.5" step="0.1" min="0.1"></label>
                    </div>
                </div>
            </div>

            <div class="form-row dist-row-inner">
                <div class="form-group">
                    <label for="value_dist">Value Distribution</label>
                    <select id="value_dist">
                        <option value="uniform">Uniform</option>
                        <option value="normal">Normal</option>
                        <option value="lognormal">Lognormal</option>
                    </select>
                    <label class="int-checkbox"><input type="checkbox" id="value_int" checked> integer</label>
                </div>
                <div class="form-group params" id="value_params">
                    <div class="param-group uniform-params">
                        <label>Min <input type="number" id="value_min" value="1" min="1"></label>
                        <label>Max <input type="number" id="value_max" value="50" min="1"></label>
                    </div>
                    <div class="param-group normal-params hidden">
                        <label>Mean <input type="number" id="value_mean" value="25" step="0.1"></label>
                        <label>SD <input type="number" id="value_sd" value="8" step="0.1" min="0.1"></label>
                    </div>
                    <div class="param-group lognormal-params hidden">
                        <label>μ <input type="number" id="value_mu" value="3" step="0.1"></label>
                        <label>σ <input type="number" id="value_sigma" value="0.5" step="0.1" min="0.1"></label>
                    </div>
                </div>
            </div>

            <div class="form-row dist-row-inner">
                <div class="form-group">
                    <label for="correlation">Correlation <span class="info-icon" id="corr_info" tabindex="0">ⓘ<div class="info-tooltip">Controls how price and value relate.<br><strong style="color:#74b9ff">Independent:</strong> drawn separately.<br><strong style="color:#55efc4">Positive:</strong> value = α × price + noise. Costlier items tend to be more valuable — harder problem.<br><strong style="color:#fab1a0">Negative:</strong> value = α × (maxPrice − price) + noise. Cheaper items tend to be more valuable — easier problem.<br>Noise ~ Normal(0, noise_sd).</div></span></label>
                    <select id="correlation">
                        <option value="independent">Independent</option>
                        <option value="positive">Positive Linear</option>
                        <option value="negative">Negative Linear</option>
                    </select>
                </div>
                <div class="form-group params" id="correlation_params">
                    <div class="param-group correlation-params hidden">
                        <label>α <input type="number" id="alpha" value="2" step="0.1"></label>
                        <label>Noise SD <input type="number" id="noise_sd" value="5" step="0.1" min="0"></label>
                    </div>
                </div>
            </div>

            <div class="form-row dist-row-last">
                <div class="form-group">
                    <label for="ratio_spread">Ratio Spread <span class="info-icon" id="ratio_info" tabindex="0">ⓘ<div class="info-tooltip">Controls variance of value/price ratios across items.<br><strong style="color:#74b9ff">Low:</strong> ratios compressed toward the mean — items look similar, harder to distinguish good deals.<br><strong style="color:#dfe6e9">Medium:</strong> no adjustment (natural variance).<br><strong style="color:#fab1a0">High:</strong> ratios stretched apart — clear bargains and bad deals, easier to spot the optimal set.</div></span></label>
                    <select id="ratio_spread">
                        <option value="low">Low (λ=0.3)</option>
                        <option value="medium" selected>Medium (λ=1.0)</option>
                        <option value="high">High (λ=2.0)</option>
                    </select>
                    <label class="int-checkbox"><input type="checkbox" id="integer_ratios"> integer ratios</label>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="optimal_size">Items in Optimal Solution</label>
                    <select id="optimal_size">
                        <option value="random">Random</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="target_sahni_k">Sahni-k <span class="info-icon" tabindex="0">ⓘ<div class="info-tooltip">Target Sahni-k: the minimum number of items to enumerate before greedy fills optimally.<br><strong style="color:#74b9ff">k=0:</strong> pure greedy is optimal (easy).<br><strong style="color:#fab1a0">Higher k:</strong> more items must be "guessed" — harder instance.<br>Capped at 6. Generation may take longer for high k.</div></span></label>
                    <select id="target_sahni_k">
                        <option value="random">Random</option>
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                </div>
                <div class="form-group seed-inline">
                    <label for="seed">Seed <span style="font-weight:400;color:#aaa">(optional)</span></label>
                    <input type="text" id="seed" value="12345" placeholder="e.g. 12345">
                </div>
            </div>

            <div class="button-row">
                <button id="generate_btn" class="primary">Generate</button>
                <button id="download_csv_btn">Download CSV</button>
                <button id="download_json_btn">Download JSON</button>
                <button id="copy_json_btn">Copy JSON</button>
            </div>
        </div>

        <div class="output-section hidden" id="output_section">
            <h2>Summary Statistics</h2>
            <div class="stats-grid" id="stats_grid"></div>

            <h2>Optimal Solution</h2>
            <div class="stats-grid" id="optimal_grid"></div>

            <h2>Preview (First 25 Items)</h2>
            <div class="table-container">
                <table id="preview_table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Value</th>
                            <th>Value/Price</th>
                        </tr>
                    </thead>
                    <tbody id="preview_body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
